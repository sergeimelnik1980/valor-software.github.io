<!DOCTYPE html><html lang="en"><head><meta name="generator" content="Scully 0.0.0">
    <meta charset="utf-8">
    <title>Cypress testing: Running tests in parallel</title>
    <base href="/">
    <meta property="og:type" content="website">
    <meta content="summary_large_image" name="twitter:card">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@ValorSoft">
    <meta name="twitter:creator" content="@ValorSoft">
    <meta property="og:image" content="assets/img/valor-img/valor_social.jpg">
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <script type="text/javascript" async="" src="https://widget.intercom.io/widget/brxsww1a"></script><script>
      window.intercomSettings = {
        app_id: "brxsww1a"
      };
    </script>
    <script>
      (function(){var w=window;var ic=w.Intercom;if(typeof ic==="function"){ic('reattach_activator');ic('update',w.intercomSettings);}else{var d=document;var i=function(){i.c(arguments);};i.q=[];i.c=function(args){i.q.push(args);};w.Intercom=i;var l=function(){var s=d.createElement('script');s.type='text/javascript';s.async=true;s.src='https://widget.intercom.io/widget/brxsww1a';var x=d.getElementsByTagName('script')[0];x.parentNode.insertBefore(s,x);};if(w.attachEvent){w.attachEvent('onload',l);}else{w.addEventListener('load',l,false);}}})();
    </script>
  <style>:root{--swiper-theme-color:#007aff}:root{--swiper-navigation-size:44px}:root{--light_font_col:#e1e1e1}html{-moz-tab-size:4;tab-size:4;line-height:1.15;-webkit-text-size-adjust:100%}body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji}html{font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;line-height:1.5}body{font-family:inherit;line-height:inherit}*,:after,:before{box-sizing:border-box;border:0 solid}*,:after,:before{--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-transform:translateX(var(--tw-translate-x)) translateY(var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));border-color:currentColor;--tw-ring-inset:var(--tw-empty,/*!*/ /*!*/);--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgba(59,130,246,.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-blur:var(--tw-empty,/*!*/ /*!*/);--tw-brightness:var(--tw-empty,/*!*/ /*!*/);--tw-contrast:var(--tw-empty,/*!*/ /*!*/);--tw-grayscale:var(--tw-empty,/*!*/ /*!*/);--tw-hue-rotate:var(--tw-empty,/*!*/ /*!*/);--tw-invert:var(--tw-empty,/*!*/ /*!*/);--tw-saturate:var(--tw-empty,/*!*/ /*!*/);--tw-sepia:var(--tw-empty,/*!*/ /*!*/);--tw-drop-shadow:var(--tw-empty,/*!*/ /*!*/);--tw-filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}body,html{height:100%;--tw-bg-opacity:1;background-color:rgba(22,22,23,var(--tw-bg-opacity));scroll-behavior:smooth}</style><link rel="stylesheet" href="styles.4d6c7dd04c84fda90ad9.css" media="all" onload="this.media='all'"><noscript><link rel="stylesheet" href="styles.4d6c7dd04c84fda90ad9.css"></noscript><style></style><meta name="description" content="We love testing; we love automating tests; we love running tests in parallel. Check out our Cypress guide for speedy and reliable testing."><meta property="og:title" content="Cypress testing: Running tests in parallel"><meta property="og:description" content="We love testing; we love automating tests; we love running tests in parallel. Check out our Cypress guide for speedy and reliable testing."><meta property="twitter:title" content="Cypress testing: Running tests in parallel"><meta property="twitter:description" content="We love testing; we love automating tests; we love running tests in parallel. Check out our Cypress guide for speedy and reliable testing."><style>
      swiper {
        display: block;
      }
    </style><script>window['ScullyIO']='generated';</script></head>
  <body scully-version="0.0.0">
    <valor-software-site-base-root _nghost-nwr-c34="" ng-version="12.2.15"><top-menu _ngcontent-nwr-c34=""><nav class="bg-grey_bg font-workSans text-base fixed top-0 w-full z-10"><div class="px-4 xl:px-28 lg:py-2.5"><div class="flex items-center justify-between h-16"><div class="flex-1 lg:flex-auto lg:hidden"><img src="assets/img/icons/burger-menu.svg" alt="burger menu icon"></div><!----><!----><div class="lg:flex flex-1 lg:flex-auto items-center"><div class="flex-shrink-0"><a routerlink="." class="cursor-pointer block justify-center flex" href="/"><img src="/assets/img/valor_img/valor-logo.svg" alt="Workflow" class="h-6 w-auto sm:h-14"></a></div><div class="hidden lg:block relative ml-20"><div class="flex space-x-2 leading-4"><div class="menu-item">For clients <div class="light-arrow"></div></div><a routerlink="/services" class="menu-item" href="/services">Services</a><a routerlink="/portfolio" class="menu-item" href="/portfolio">Portfolio</a><a routerlink="/careers" class="menu-item" href="/careers">Careers</a><a routerlink="/blog" class="menu-item active-route" href="/blog">Blog</a></div><menu-popover class="hidden lg:block"><div class="hidden lg:block"><div class="popover pt-10 px-10 z-20"><div class="arrow"></div><div class="flex justify-between flex-wrap"><div changesrconhover="" class="w-45% cursor-pointer text-light_font_col mb-12" tabindex="0"><div class="flex mb-2.5"><div class="flex items-center"><img src="/assets/img/icons/startups.svg"><h3 class="ml-2.5">Startups</h3></div><!----></div><div><p class="text-grey_font_col text-sm">Software development from scratch to market launch</p></div></div><div changesrconhover="" class="w-45% cursor-pointer text-light_font_col mb-12" tabindex="0"><div class="flex mb-2.5"><div class="flex items-center"><img src="/assets/img/icons/enterprises.svg"><h3 class="ml-2.5">Enterprises</h3></div><!----></div><div><p class="text-grey_font_col text-sm">Future-oriented solutions to solve today's problems and anticipate tomorrow’s needs</p></div></div><div changesrconhover="" class="w-45% cursor-pointer text-light_font_col mb-12" tabindex="0"><div class="flex mb-2.5"><div class="flex items-center"><img src="/assets/img/icons/smbs.svg"><h3 class="ml-2.5">SMBs</h3></div><!----></div><div><p class="text-grey_font_col text-sm">Budget-wise solutions for small to medium-sized businesses</p></div></div><div changesrconhover="" class="w-45% cursor-pointer text-light_font_col mb-12" tabindex="0"><div class="flex mb-2.5"><div class="flex items-center"><img src="/assets/img/icons/non-profits.svg"><h3 class="ml-2.5">Non-profits</h3></div><!----></div><div><p class="text-grey_font_col text-sm">Technology solutions for non-governmental organizations</p></div></div><!----></div></div><div class="backdrop"></div></div><div class="adaptive-popover"><div tabindex="0"><div class="flex mb-7"><div class="flex items-center"><img src="/assets/img/icons/startups.svg"><h3 class="ml-2.5 text-xl">Startups</h3></div><!----></div></div><div tabindex="0"><div class="flex mb-7"><div class="flex items-center"><img src="/assets/img/icons/enterprises.svg"><h3 class="ml-2.5 text-xl">Enterprises</h3></div><!----></div></div><div tabindex="0"><div class="flex mb-7"><div class="flex items-center"><img src="/assets/img/icons/smbs.svg"><h3 class="ml-2.5 text-xl">SMBs</h3></div><!----></div></div><div tabindex="0"><div class="flex"><div class="flex items-center"><img src="/assets/img/icons/non-profits.svg"><h3 class="ml-2.5 text-xl">Non-profits</h3></div><!----></div></div><!----></div></menu-popover></div></div><div class="lg:block flex-1 lg:flex-auto"><div class="flex items-end justify-end"><button type="button" class="btn-pink-border text-xs md:text-base"> Get in touch </button></div></div></div></div><div id="mobile-menu" class="adaptive-menu"><div class="px-2 pt-2 pb-3 space-y-1"><div class="menu-item">For clients <div class="light-arrow big"></div></div><menu-popover class="block lg:hidden !m-0"><div class="hidden lg:block"><div class="popover pt-10 px-10 z-20"><div class="arrow"></div><div class="flex justify-between flex-wrap"><div changesrconhover="" class="w-45% cursor-pointer text-light_font_col mb-12" tabindex="0"><div class="flex mb-2.5"><div class="flex items-center"><img src="/assets/img/icons/startups.svg"><h3 class="ml-2.5">Startups</h3></div><!----></div><div><p class="text-grey_font_col text-sm">Software development from scratch to market launch</p></div></div><div changesrconhover="" class="w-45% cursor-pointer text-light_font_col mb-12" tabindex="0"><div class="flex mb-2.5"><div class="flex items-center"><img src="/assets/img/icons/enterprises.svg"><h3 class="ml-2.5">Enterprises</h3></div><!----></div><div><p class="text-grey_font_col text-sm">Future-oriented solutions to solve today's problems and anticipate tomorrow’s needs</p></div></div><div changesrconhover="" class="w-45% cursor-pointer text-light_font_col mb-12" tabindex="0"><div class="flex mb-2.5"><div class="flex items-center"><img src="/assets/img/icons/smbs.svg"><h3 class="ml-2.5">SMBs</h3></div><!----></div><div><p class="text-grey_font_col text-sm">Budget-wise solutions for small to medium-sized businesses</p></div></div><div changesrconhover="" class="w-45% cursor-pointer text-light_font_col mb-12" tabindex="0"><div class="flex mb-2.5"><div class="flex items-center"><img src="/assets/img/icons/non-profits.svg"><h3 class="ml-2.5">Non-profits</h3></div><!----></div><div><p class="text-grey_font_col text-sm">Technology solutions for non-governmental organizations</p></div></div><!----></div></div><div class="backdrop"></div></div><div class="adaptive-popover"><div tabindex="0"><div class="flex mb-7"><div class="flex items-center"><img src="/assets/img/icons/startups.svg"><h3 class="ml-2.5 text-xl">Startups</h3></div><!----></div></div><div tabindex="0"><div class="flex mb-7"><div class="flex items-center"><img src="/assets/img/icons/enterprises.svg"><h3 class="ml-2.5 text-xl">Enterprises</h3></div><!----></div></div><div tabindex="0"><div class="flex mb-7"><div class="flex items-center"><img src="/assets/img/icons/smbs.svg"><h3 class="ml-2.5 text-xl">SMBs</h3></div><!----></div></div><div tabindex="0"><div class="flex"><div class="flex items-center"><img src="/assets/img/icons/non-profits.svg"><h3 class="ml-2.5 text-xl">Non-profits</h3></div><!----></div></div><!----></div></menu-popover><a routerlink="/services" class="menu-item" href="/services">Services</a><a routerlink="/portfolio" class="menu-item" href="/portfolio">Portfolio</a><a routerlink="/careers" class="menu-item" href="/careers">Careers</a><a routerlink="/blog" class="menu-item active-route" href="/blog">Blog</a></div></div></nav></top-menu><div _ngcontent-nwr-c34="" class="mb-28 font-workSans" style="min-height: 100%;"><router-outlet _ngcontent-nwr-c34=""></router-outlet><general-item><article><section class="first-section-half landing-section mt-4 bg-dark_title_col lg:!pb-32 !pb:8"><div class="container flex items-center flex-col"><breadcrumbs class="w-full hidden md:block"><div><div class="flex text-grey_font_col"><p class="underline cursor-pointer">Home</p><span>&nbsp;&gt;&nbsp;</span><p class="underline cursor-pointer"> Blog </p><!----><!----><!----><span>&nbsp;&gt;&nbsp;</span><p class="disabled"> Cypress Testing: Running Tests In Parallel </p><!----><!----><!----><!----></div></div><!----></breadcrumbs><!----><!----><div class="w-full flex flex-col items-center md:mt-12 lg:mt-32 max-w-full lg:max-w-75% text-center text-light_title_col"><p class="text-20 mb-4">March 25, 2019</p><p class="text-large font-bold md:text-64 leading-66 mb-8 md:mb-14">Cypress testing: Running tests in parallel</p><div class="w-70 h-70 rounded-full overflow-hidden mb-4"><img class="w-full h-full object-cover" src="https://assets.website-files.com/5c4c30d0c49ea6746fafc90c/5f69eabbb804c9c13508347a_nesvitiy.jpg" alt="Ludmila Nesvitiy"></div><!----><p class="md:text-large text-24 mb-4">Ludmila Nesvitiy</p><!----><p class="text-20">QA Automation Engineer</p><!----></div></div></section><section class="landing-section"><div class="container pt-4 md:pt-12 flex items-center flex-col article-box !max-w-1010"><div class="max-w-full"> <p>Facing bugs is usual for web application development. If your team ignores tests or you
    do not test the code, issues in the project become evident and over time they can become a total blocker and
    eventually kill your project. Therefore, in many teams, there is a testing engineer who catches bugs and reports
    them to the team.</p> <p>We, as a reliable software vendor, don't want to undermine customer confidence in us,
    so we incorporated Cypress.io - a platform for automatic testing to find and correct errors on time.</p><h5>Table
    of contents</h5>
    <ol>
        <li>Why we love Cypress</li>
        
        <li>Parallelization task</li>
        
        <li>Instruments, Source data, Implementation plan</li>
        
        <li>Solution: Green phase</li>
        
        <li>Solution: Yellow phase</li>
        
        <li>Results</li>
        
    </ol>
     <h4>Why we love Cypress</h4> <p>There are many ways to test, yet in this article, we would like to limit
        ourselves to two of them - e2e and integration testing.<br>The Cypress.io platform is excellent for testing
        web-application interfaces. Its main task is to check how the client part interacts with the server part, and
        the individual components of the page interact with each other.<br></p> <p><strong>Platform
        benefits:</strong><br></p>
    <ul>
        <li>Can be quickly built into the project.</li>
        
        <li>Supports all levels of tests (e2e, integration, unit).</li>
        
        <li>Takes snapshots for each test step for easy debugging.</li>
        
        <li>Able to access every web-page object in the DOM.</li>
        
        <li>When expecting any condition, Cypress tries to check it a few times, before sending failures after the 1st
            try.
        </li>
        
        <li>Able to work with our favorite continuous integration system (TravisCI).<br></li>
        
    </ul>
     <p>Cypress works on a predetermined scenario. Even if you haven't written tests before, clear documentation
        will help you start.</p><h4>Parallel testing</h4> <p>Now to the most exciting part - parallelization. Here's
        a brief extract from the official documentation explaining what parallelization is and why it is needed:<br>
    </p>
    <blockquote><em>If your project has a large number of tests, it can take a long time for tests to complete running
        serially on one machine. Running tests in parallel across many virtual machines can save your team time and
        money when running tests in Continuous Integration (CI).</em><br></blockquote>
     <p>As we said earlier, Cypress has great docset, even with examples, and parallelization is not an exception: <a href="https://docs.cypress.io/guides/guides/parallelization.html" target="_blank" data-rt-link-type="external">official documentation</a> provides you with step by step description about the
        parallel run.<br>However, because of our specific basic project data, which includes many instances, types of
        tests, and scopes, implementation has been a tough process for us. Let's move through the main steps and
        issues, which we've faced, and find a solution for each of them :)<br></p> <p><strong>Goal</strong>: Decrease
        time to run e2e tests, speed up CI builds.</p><h4>Instruments, Source data, Implementation plan<br></h4> <p>
        <strong>Instruments: </strong></p>
    <ul>
        <li><a href="https://cypress.io" target="_blank" data-rt-link-type="external">Cypress </a></li>
        
        <li><a href="https://www.cypress.io/dashboard/" target="_blank" data-rt-link-type="external">Cypress
            Dashboard</a></li>
        
        <li>TypeScript for test code</li>
        
        <li><a href="https://github.com/cypress-io/cypress-webpack-preprocessor" target="_blank" data-rt-link-type="external">cypress/webpack-preprocessor</a> - a plugin for compiling
        </li>
        
        <li><a href="https://github.com/TypeStrong/ts-loader" target="_blank" data-rt-link-type="external">ts-loader</a>
            - TypeScript loader for Webpack
        </li>
        
        <li><a href="https://travis-ci.org" target="_blank" data-rt-link-type="external">Travis</a> - CI tool.<br>
        </li>
        
    </ul>
     <p><strong>Source data: </strong></p> <p>There are two scopes of e2e automated tests in the project:</p>
    <ul>
        <li>Integration (about 70 tests)</li>
        
        <li>Full (about 450 tests at the time of this writing).</li>
        
    </ul>
     <p>There are also a few instances, which should be tested by e2e tests:</p>
    <ul>
        <li>localhost:4200</li>
        
        <li><a href="https://ngx-universal.herokuapp.com/#/" target="_blank" data-rt-link-type="external">ngx-universal.herokuapp.com </a>
        </li>
        
        <li><a href="http://ngx-bootstrap-latest.surge.sh/#/" target="_blank" data-rt-link-type="external">ngx-bootstrap-latest.surge.sh </a>
        </li>
        
        <li><a href="https://valor-software.com/ngx-bootstrap/#/" target="_blank" data-rt-link-type="external">valor-software.com/ngx-bootstrap.</a><br>
        </li>
        
    </ul>
     <p><strong>Parallelization implementation plan:</strong></p>
    <ul>
        <li>Integration of e2e tests running for each PR (pull request) for the local build</li>
        
        <li>Integration and full e2e tests running for each merge to `development` branch at automatically deployed
            build into two different instances (two different URLs)
        </li>
        
        <li>Integration and full e2e tests running for each new release for a production instance (the third URL).<br>
        </li>
        
    </ul>
     <p>This plan can be visually presented as a timeline:<br></p>
    <figure class="w-richtext-figure-type-image w-richtext-align-fullwidth \
    " data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="1153px" style="max-width:1153px">
    <div><img src="https://uploads-ssl.webflow.com/5c4c30d0c49ea6746fafc90c/5cacae969ffb28e551a5ff58_Screenshot%20from%202019-04-09%2017-38-54.png" alt="The plan presented as a timeline">
    </div>
        </figure><p>We're going to describe parallelization implementation in two phases: green and yellow.</p> <p>
        <strong>Solution: Green phase</strong><br></p> <p>The green phase consists of two steps, so there don't seem
        to be any complications:</p>
    <ol>
        <li>Add a few extra settings to the cypress.json:<br></li>
        
    </ol>
    
    <pre>"video": false, (for quick run)
"projectId": "yourID", (for link CY dashboard service to each run)</pre>
    
    <ol start="2">
    <li>Make a command for CI run with additional parameters:</li>
        </ol>
    <pre>- your command -- --record --key $CY_KEY --parallel</pre>
     <p>A-and that's it, these are the whole settings to be added (according to the documentation). However, in real
        life... in real life, we got a huge travis.yml and a little misbehavior.<br></p> <p>Before parallelization,
        our Travis configuration looked like this:<br></p>
    <pre>- script:
ng serve --prod &amp; $(npm bin)/wait-on http-get://$URL
npm run cy:run:smoke
kill $(jobs -p) || true
name: "Run cypress smoke testing"
env: URL=localhost:4200/#</pre>
     <p>To be clear, this script builds project locally, waits until the app is up and running, runs tests, and
        finally kills all processes when they are finished. For these needs you can also use the <a href="https://github.com/bahmutov/start-server-and-test" data-rt-link-type="external">start-server-and-test</a>
        library.</p> <p>After adding parameters for parallelization, our Travis config looks like:</p>
    <figure class="w-richtext-figure-type-image w-richtext-align-fullwidth \
    " data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="1600px" style="max-width:1600px">
    <div><img src="https://uploads-ssl.webflow.com/5c4c30d0c49ea6746fafc90c/5cab18d1f8e0122074e675cd_f7xbhesGwc6bnK96npjdBOHv30bhgOxPp1Zvrjugs5BvMIs80tptMSQRq5Sfd8iOgyabnt48zlXbtoEaiwz2pH4r-sRw4miJAZIvRjcgPW_68KUlniyBv7EIIHuDZjSrpZZRgAe7.png" alt="Travis config">
    </div>
        </figure><p>In this case, the number of our threads will be three. So we need to have three machines on Travis
        for running all these tests. When our CI run finishes, we'll see list of scripts which we've ran and amount of
        time spent by each Travis machine during start, test run, and kill:</p>
    <figure class="w-richtext-figure-type-image w-richtext-align-fullwidth \
    " data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="815px" style="max-width:815px">
    <div><img src="https://uploads-ssl.webflow.com/5c4c30d0c49ea6746fafc90c/5c98b78cd784214e809596d7_dDlLB0L_DjPrGd-SOAebWu5jcTfFvMbt4EcpiUxDhZSBJT06QmcGS8jxw7cyxpBHZ9o60JjIyRcSj3kLeBuTbYDkzy3ckAjwHdnlbD4BrUrYRgGjDGFmb4jHJNrGHuE1MV_NJVIJ.png" alt="The list of scripts which we've ran and amount of time spent by each Travis machine during start,
        test run, and kill">
    </div>
        </figure><p>Time, which is displayed on Travis, was spent on starting the machine, installing development
        packages, building the library and Demo application, and running test.<br></p> <p>It looks like there's no
        problem at all, but on the CI Dashboard we'll see that only two machines took part in the test run. The
        Dashboard also shows us time, which was spent for the direct test run: 2:26 minutes.<br></p>
    <figure class="w-richtext-figure-type-image w-richtext-align-fullwidth \
    " data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="1525px" style="max-width:1525px">
    <div><img src="https://uploads-ssl.webflow.com/5c4c30d0c49ea6746fafc90c/5c98b78c6929126465bb7749_5jJAhf0_shpDqdSn5RoXQHSQjoxJgYqInP2mS6QlMp-JAW-selWm2CuF37meAav1-vICO4nryz75ihbtEa_T1VbeAsa6X9O6fM3E2x9TKDRcKFVg_bgJTgUI9Ws8SZ-P_EgupHNo.png" alt="The Dashboard shows time, which was spent for the direct test run.">
    </div>
        </figure><p>If we dive deeper into the job on the third Travis machine, we'll see that the job actually has
        started, but not in time:<br></p>
    <figure class="w-richtext-figure-type-image w-richtext-align-fullwidth \
    " data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="1244px" style="max-width:1244px">
    <div><img src="https://uploads-ssl.webflow.com/5c4c30d0c49ea6746fafc90c/5ca7390f89cf383d85edc1a7_9ZBi8xYYrDUZCPkf3fWQpZVhYtVVxmhvvzJhqwkiMPDfw2j9XDapV9pmQ1XFoWAcrRfmcF4qoAB43Uhu7bFjzmXtO6k8JBnU4kneguPRkMMuTJ9jK_kn0Jiw_jFRvRYEv5gELRel.png" alt="Screen. The job actually has started, but not in time">
    </div>
        </figure> <p>What happened?</p> <p>Travis machines are ready to run the tests, but not
        simultaneously. </p> <p>The first machine can start at 01:00:00, the second one at 01:02:00, and the third one
        will start at 01:05:00. And if your test run takes less than five minutes, then the third thread will be
        empty. It didn't even get to run one little test :"( &nbsp; <br></p> <p><strong>Solution: Yellow
        phase</strong><br></p> <p>At this stage, all we have to do is to add similar commands and configuration for
        other instances. Because of the similarities of the test scope, we just set an additional parameter for
        changing base URL, and add a new function for running tests which we'll reuse in each stage:<br></p>
    <pre>testPostDeploy: &amp;testPostDeploy
script: CYPRESS_baseUrl=$BASE_URL npm run cy:run:all -- --record --key $CY_KEY --parallel --group $GROUP_NAME</pre>
     <p>This is a very common function, which is applied to the next parameters:</p>
    <ul>
        <li>CYPRESS_baseUrl - one of our instances from the matrix above</li>
        
        <li>--record - sends results to the Dashboard</li>
        
        <li>--key - determines which account from the dashboard we will use</li>
        
        <li>--parallel - runs our tests in parallel</li>
        
        <li>--group - combines tests in different groups.</li>
        
    </ul>
     <p>In each script we need to define BASE_URL and GROUP_NAME parameters, as other parameters are defined
        globally already. </p> <p>And you may be surprised with following command:<br></p>
    <pre> npm run cy:run:all</pre>
     <p>This command unfolded means the following:</p>
    <pre>cy:run:all": "cypress run --config integrationFolder=cypress"</pre>
     <p>"Why surprised?" you ask, okay, look: </p> <p>Because each test scope lives in a separate directory with
        the appropriate name: 'integration' and 'full.' To run these tests altogether, just set the global directory
        for the run. Also, make sure to exclude all unnecessary directories and files from this run (using
        "ignoreTestFiles"parameter in cypress.json), or, otherwise, you could get an error like: "The tests were
        unable to run: Oops...we found an error preparing this test file: ..."</p> <p>Instead of specifying the
        folder, you could use --specs parameter with a global pattern, like:<br></p>
    <pre>cypress run --config integrationFolder=cypress --spec '**/*_spec.ts</pre>
     <p>Our configuration for the first instance looks like this now:<br></p>
    <pre>name: "Cypress suit run on SSR 1thread"
env:
- GROUP_NAME=3x-electron
- BASE_URL=https://ngx-universal.herokuapp.com/#/
&lt;\t&lt;: *testPostDeploy
- script:
name: "Cypress suit run on SSR 2thread"
env:
- GROUP_NAME=3x-electron
- BASE_URL=https://ngx-universal.herokuapp.com/#/
&lt;\t&lt;: *testPostDeploy
- script:
name: "Cypress suit run on SSR 3thread"
env:
- GROUP_NAME=3x-electron
- BASE_URL=https://ngx-universal.herokuapp.com/#/
&lt;\t&lt;: *testPostDeploy</pre>
     <p>Just to remind you, Travis stages run consistently, and Travis jobs inside one stage run in parallel. This
        provides the possibility to run tests on different machines inside the first stage. You can add as many
        scripts as you need, and each of the scripts will run in their separate thread.</p> <p>In our example above,
        integration and the full test scope will run in three threads.</p> <p>To finish what we have started, we need
        to add a similar configuration for the two remaining instances.</p> <p>Okay, imagine that's done, But what do
        we have now? Of course, an error:<br></p>
    <blockquote>"<em>The run you are attempting to access is already complete and will not accept new groups.</em>"
        <br></blockquote>
    
    <figure class="w-richtext-figure-type-image w-richtext-align-fullwidth \
    " data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="1286px" style="max-width:1286px">
    <div><img src="https://uploads-ssl.webflow.com/5c4c30d0c49ea6746fafc90c/5c98b78c544edd8398605408_TkxUBkM5og4kOIbqBEqQhXxo4ICR9yi7_u6oPMscqTWXrcLkbaSuIpszjavnieBG1zjx0IJXP3Vm2Yv7zOzZtFr1V-GX_FWognMnu6LTRNPmYdm2s1yIauaOxnbNmNYg6m4wj_X-.png" alt="The Error">
    </div>
        </figure><p>What is the reason for this mess?</p> <p>Cypress uses ci-build-id and groups flags for grouping
        our tests into test runs. So you need to set unique build-ids and unique groups inside each Travis stage. </p>
     <p>To resolve this inconvenience, set different values for --group flag and --ci-build-id flag inside each
        Travis stage. As a result, our function should look similar to the following:<br></p>
    <pre>testPostDeploy: &amp; testPostDeploy
script: CYPRESS_baseUrl=$BASE_URL npm run cy:run:all -- --record --key $CY_KEY --parallel --group $GROUP_NAME --ci-build-id PostDeploy-$GROUP_NAME-$TRAVIS_BUILD_ID</pre>
     <p>Another way to solve this issue is to set a "run completion delay" - the time that the run waits for new
        groups before completing (in seconds). All you need is to go to the Dashboard =&gt; Project =&gt; Settings and
        set this time into "Parallelization"section:</p>
    <figure class="w-richtext-figure-type-image w-richtext-align-fullwidth \
    " data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="858px" style="max-width:858px">
    <div><img src="https://uploads-ssl.webflow.com/5c4c30d0c49ea6746fafc90c/5cadabdc417d96b167228524_Screenshot%20from%202019-04-10%2011-33-22.png" alt="Set this time into &quot; Parallelization&quot; section">
    </div>
        </figure><p>However, when we thought that we were done, an unpredictable phase of stabilization emerges.</p>
    <p>In our case, when the number of tests reached 400+, we were greeted with a "FATAL ERROR: CALL_AND_RETRY_LAST
        Allocation failed - JavaScript heap out of memory" issue.<br></p>
    <figure class="w-richtext-figure-type-image w-richtext-align-fullwidth \
    " data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="776px" style="max-width:776px">
    <div><img src="https://uploads-ssl.webflow.com/5c4c30d0c49ea6746fafc90c/5ca738fe04fdce4d0e9235c9_YREV9zf5eOjr4GFXmy76Z3ms9_-sgH_GixYnLGgjifRO6rZTaFWYCeAI9qAY91ZC9q0yjB5RqQUwrqZWMXqwCHCyRbVa9P62-uSbk94s8k_egn2GpjTEmtU8gYlN3R9Gr7rlG4Qn.png" alt="Greeted with a FATAL ERROR: CALL_AND_RETRY_LAST Allocation failed - JavaScript heap out of
            memory issue.">
    </div>
        </figure> <p>To deal with this issue, we've checked <a href="https://github.com/cypress-io/cypress/issues/2316" target="_blank" data-rt-link-type="external">Cypress GitHub bug tracker</a> and found a solution there!
        According to provided information, we need to add an extra option for ts-loader, like so:</p>
    <pre>{
    loader: 'ts-loader',
    options: {
        transpileOnly: true
    }
}</pre>
     <p>And magic happens.. It a.c.t.u.a.l.l.y works, phew!</p>
    <figure class="w-richtext-figure-type-image w-richtext-align-fullwidth \
    " data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="1561px" style="max-width:1561px">
    <div><img src="https://uploads-ssl.webflow.com/5c4c30d0c49ea6746fafc90c/5c98b78cd784213e1e9596d8_2TLQijarlStUBS8zl89d5nPI-ODRPKvhOmXojaArDa5jTjkcFGE6Q4O7R-dg1ZwYZIizTBLNYRXCZ6ijSmbWyj9TO1zkpCeOOe03qaBWrONlCEjLpwab_xE-qyWU8c20COgMCe9C.png" alt="add an extra option for ts-loader">
    </div>
        </figure><p>According to our results from the following screenshot, our 522 tests took about 10 minutes. Note
        that the biggest specs were run first and the smallest were latest.</p>
    <figure class="w-richtext-figure-type-image w-richtext-align-fullwidth \
    " data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="1542px" style="max-width:1542px">
    <div><img src="https://uploads-ssl.webflow.com/5c4c30d0c49ea6746fafc90c/5c98b78d544edde73b605409_l1PcV6xixQCMNa1M0l3Qs_Vdw5Lzyw4UuRP2wPUBw556P79s3Rf_Meq3otSupxU2out5Gf_tjj513ojmrsZfnWziLFtmXONFnzhw7Kqf6FnWcrVAnOU84wPoR37P-mtZwLuNGkBh.png" alt="The results">
    </div>
        </figure><p><strong>Results</strong></p> <p>While we were implementing parallelization, the number of our
        tests increased several times. However, let's count the average time (in minutes) that it takes to run them
        (this statistic actual for the period from February to March of 2019).<br></p>
    <figure class="w-richtext-figure-type-image w-richtext-align-fullwidth \
    " data-rt-type="image" data-rt-align="fullwidth" data-rt-max-width="1503px" style="max-width:1503px">
    <div><img src="https://uploads-ssl.webflow.com/5c4c30d0c49ea6746fafc90c/5c98eff8de94e85e2807f5c5_rh1xcaXL1IYqJQNMxZTQbEdKKd63SX9HCxVbj3bI9AgYwwUIj4DO1KRo0N2Qz_AdoEVoiYC-TyF1kCtlMu2VFJZTisC7rJcBOqiNYehCF7oSIRaLRjgyRJmQwTTRJoUT2wGF_-tz.png" alt="The statistic actual for the period from February to March of 2019).">
    </div>
        </figure><p>These are just words. Where is the proof?</p>
    <ul>
        <li><a href="https://dashboard.cypress.io/#/projects/5mm2dy/runs" target="_blank" data-rt-link-type="external">NGX-bootstrap Cypress Dashboard with the history of test runs </a></li>
        
        <li><a href="https://github.com/valor-software/ngx-bootstrap/tree/development/cypress" target="_blank" data-rt-link-type="external">Main cypress directory with tests </a></li>
        
        <li><a href="https://github.com/valor-software/ngx-bootstrap/blob/development/.travis.yml" target="_blank" data-rt-link-type="external">Latest Travis configuration.</a><br></li>
        
    </ul>
     <p><strong>Useful information <br></strong><a href="https://github.com/cypress-io/cypress-example-kitchensink/blob/master/.travis.yml" target="_blank" data-rt-link-type="external">Parallelization example</a> provided <a href="https://dashboard.cypress.io/#/projects/4b7344/runs/2929/specs" target="_blank" data-rt-link-type="external">officially by CY.</a><br></p> <p><strong>Thank you
        words<br></strong>The biggest kudos go to the Cypress team for supplying us with a free plan to try out the
        Cypress Parallelization feature for our <a href="https://valor-software.com/ngx-bootstrap/#/" target="_blank" data-rt-link-type="external">ngx-bootstrap</a>
        open-source library and a huge thanks to everyone who contributed!<br></p>
</div>
</div></section><section class="landing-section"><div class="container"><h1 class="main-title double">More Articles</h1><blog-preview><swiper class="article_swiper swiper swiper-initialized swiper-horizontal swiper-pointer-events"><!----><!----><div class="swiper-pagination swiper-pagination-clickable swiper-pagination-bullets swiper-pagination-horizontal"><span class="swiper-pagination-bullet swiper-pagination-bullet-active"></span><span class="swiper-pagination-bullet"></span><span class="swiper-pagination-bullet"></span></div><!----><div class="swiper-wrapper" style="transform: translate3d(0px, 0px, 0px);"><!----><!----><div data-swiper-slide-index="0" class="swiper-slide swiper-slide-active" style="width: 733px; margin-right: 40px;"><!----><blog-portfolio-item class="w-full cursor-pointer"><div class="article-item"><div class="img-container zoom-img-scale"><img class="w-full h-full object-cover" src="https://assets.website-files.com/5c4c30d0c49ea6746fafc90c/625565877dc7641e35ec9ce3_Announcing%20strategic%20partnership.png" alt="Announcing strategic partnership with Zack Jackson, the Module Federation inventor"></div><div class="text-container"><p>Announcing strategic partnership with Zack Jackson, the Module Federation inventor</p></div></div></blog-portfolio-item><!----><!----><!----></div><div data-swiper-slide-index="1" class="swiper-slide swiper-slide-next" style="width: 733px; margin-right: 40px;"><!----><blog-portfolio-item class="w-full cursor-pointer"><div class="article-item"><div class="img-container zoom-img-scale"><img class="w-full h-full object-cover" src="https://valor-software.com/assets/images/624495a97b77ab1729aaf5ad_Implementing_20WebSockets_20plugin_20for_20NativeScript_20using_20React_20Native.png" alt="Implementing WebSockets plugin for NativeScript using React Native"></div><div class="text-container"><p>Implementing WebSockets plugin for NativeScript using React Native</p></div></div></blog-portfolio-item><!----><!----><!----></div><div data-swiper-slide-index="2" class="swiper-slide" style="width: 733px; margin-right: 40px;"><!----><blog-portfolio-item class="w-full cursor-pointer"><div class="article-item"><div class="img-container zoom-img-scale"><img class="w-full h-full object-cover" src="https://valor-software.com/assets/images/620e51e34b7146e6290802db_HTML_editing_valor_software.jpeg" alt="TagTide library: make your HTML editor-friendly and more"></div><div class="text-container"><p>TagTide library: make your HTML editor-friendly and more</p></div></div></blog-portfolio-item><!----><!----><!----></div><!----><!----><!----><!----></div><!----></swiper><!----><!----></blog-preview></div></section><!----><!----></article><!----><!----><!----></general-item><!----></div><app-footer _ngcontent-nwr-c34=""><footer><div class="px-4 xl:px-28 pb-6"><div class="w-full flex flex-col-reverse md:flex-row items-center justify-between border-t-2 border-placeholder_col pt-6"><div class="flex-shrink-0"><a routerlink="." class="cursor-pointer" href="/"><img src="/assets/img/valor_img/valor-logo.svg" alt="Workflow" class="h-14 w-70 md:w-full"></a></div><div class="hidden lg:flex items-center"><div class="leading-4 flex"><div class="lg:w-75 !mr-10"><a href="https://www.linkedin.com/company/valor-software/about/" target="_blank" class="block transition-all text-header_font_col hover:font-bold">LinkedIn</a></div><div class="lg:w-75 !mr-10"><a href="https://www.facebook.com/valorsoftware/" target="_blank" class="block transition-all text-header_font_col hover:font-bold">Facebook</a></div><div class="lg:w-75 !mr-10"><a href="https://twitter.com/ValorSoft" target="_blank" class="block transition-all text-header_font_col hover:font-bold">Twitter</a></div><div class="lg:w-75 !mr-10"><a href="https://www.instagram.com/valor.software/" target="_blank" class="block transition-all text-header_font_col hover:font-bold">Instagram</a></div><div class="lg:w-75 !mr-10"><a href="https://dribbble.com/valor-labs" target="_blank" class="block transition-all text-header_font_col hover:font-bold">Dribbble</a></div><div class="lg:w-75 !mr-10"><a href="https://www.behance.net/ValorSoftware" target="_blank" class="block transition-all text-header_font_col hover:font-bold">Behance</a></div><div class="lg:w-75 !mr-10"><a href="https://github.com/valor-software" class="block transition-all text-header_font_col hover:font-bold">GitHub</a></div><div class="lg:w-75 !mr-10"><a href="https://valorsoftware.medium.com/" class="block transition-all text-header_font_col hover:font-bold">Medium</a></div></div><div class="hidden 2xl:block 2xl:flex-1 2xl:flex-auto ml-10"><div class="flex items-end justify-end"><button type="button" class="btn-pink-border text-xs md:text-base"> Get in touch </button></div></div></div><div class="flex flex-wrap lg:hidden mb-4 md:mb-0 justify-center md:justify-between w-full md:w-auto"><a href="https://www.linkedin.com/company/valor-software/about/" target="_blank" class="w-20% md:w-auto flex justify-center md:mr-10 text-header_font_co mb-4 md:mb-0"><img src="assets/img/icons/social/linkedin.svg" alt=""></a><a href="https://www.instagram.com/valor.software/" target="_blank" class="flex justify-center w-20% md:w-auto block md:mr-10 text-header_font_col mb-4 md:mb-0"><img src="assets/img/icons/social/instagram.svg" alt=""></a><a href="https://twitter.com/ValorSoft" target="_blank" class="flex justify-center w-20% md:w-auto block md:mr-10 text-header_font_col mb-4 md:mb-0"><img src="assets/img/icons/social/twitter.svg" alt=""></a><a href="https://dribbble.com/valor-labs" target="_blank" class="flex justify-center w-20% md:w-auto block md:mr-10 text-header_font_col mb-4 md:mb-0"><img src="assets/img/icons/social/dribble.svg" alt=""></a><a href="https://www.behance.net/ValorSoftware" target="_blank" class="flex justify-center w-20% md:w-auto block md:mr-10 text-header_font_col mb-4 md:mb-0"><img src="assets/img/icons/social/behance.svg" alt=""></a><a href="https://www.facebook.com/valorsoftware/" target="_blank" class="flex justify-center w-20% md:w-auto block md:mr-10 text-header_font_col mb-4 md:mb-0"><img src="assets/img/icons/social/facebook.svg" alt=""></a><a href="https://github.com/valor-software" target="_blank" class="flex justify-center md:mr-10 w-20% md:w-auto block text-header_font_col mb-4 md:mb-0"><img src="assets/img/icons/social/github.svg" alt=""></a><a href="https://valorsoftware.medium.com/" target="_blank" class="flex justify-center w-20% md:w-auto block text-header_font_col mb-4 md:mb-0"><img src="assets/img/icons/social/medium.svg" alt=""></a></div></div><div class="mt-4 md:mt-7"><p class="m-0 text-center text-header_font_col text-sm">© 2022, Valor Software All Rights Reserved</p></div></div></footer></app-footer></valor-software-site-base-root>
    <script async="" src="assets/js/prettify.min.js"></script>
  <script id="ScullyIO-transfer-state"></script><script src="runtime.e7b40324d47b093f14cd.js" defer=""></script><script src="polyfills.63ae310b789829f5ae56.js" defer=""></script><script src="main.07ea90130a801f14df02.js" defer=""></script>

<iframe id="intercom-frame" style="position: absolute !important; opacity: 0 !important; width: 1px !important; height: 1px !important; top: 0 !important; left: 0 !important; border: none !important; display: block !important; z-index: -1 !important; pointer-events: none;" aria-hidden="true" tabindex="-1" title="Intercom"></iframe><div class="intercom-lightweight-app"><style id="intercom-lightweight-app-style" type="text/css">
  @keyframes intercom-lightweight-app-launcher {
    from {
      opacity: 0;
      transform: scale(0.5);
    }
    to {
      opacity: 1;
      transform: scale(1);
    }
  }

  @keyframes intercom-lightweight-app-gradient {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }

  @keyframes intercom-lightweight-app-messenger {
    from {
      opacity: 0;
      transform: translateY(20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .intercom-lightweight-app {
    position: fixed;
    z-index: 2147483001;
    width: 0;
    height: 0;
    font-family: intercom-font, "Helvetica Neue", "Apple Color Emoji", Helvetica, Arial, sans-serif;
  }

  .intercom-lightweight-app-gradient {
    position: fixed;
    z-index: 2147483002;
    width: 500px;
    height: 500px;
    bottom: 0;
    right: 0;
    pointer-events: none;
    background: radial-gradient(
      ellipse at bottom right,
      rgba(29, 39, 54, 0.16) 0%,
      rgba(29, 39, 54, 0) 72%);
    animation: intercom-lightweight-app-gradient 200ms ease-out;
  }

  .intercom-lightweight-app-launcher {
    position: fixed;
    z-index: 2147483003;
    bottom: 20px;
    right: 20px;
    width: 60px;
    height: 60px;
    border-radius: 50%;
    background: undefined;
    cursor: pointer;
    box-shadow: 0 1px 6px 0 rgba(0, 0, 0, 0.06), 0 2px 32px 0 rgba(0, 0, 0, 0.16);
    animation: intercom-lightweight-app-launcher 250ms ease;
  }

  .intercom-lightweight-app-launcher:focus {
    outline: none;
    
  }

  .intercom-lightweight-app-launcher-icon {
    display: flex;
    align-items: center;
    justify-content: center;
    position: absolute;
    top: 0;
    left: 0;
    width: 60px;
    height: 60px;
    transition: transform 100ms linear, opacity 80ms linear;
  }

  .intercom-lightweight-app-launcher-icon-open {
    
        opacity: 1;
        transform: rotate(0deg) scale(1);
      
  }

  .intercom-lightweight-app-launcher-icon-open svg {
    width: 28px;
    height: 32px;
  }

  .intercom-lightweight-app-launcher-icon-open svg path {
    fill: undefined;
  }

  .intercom-lightweight-app-launcher-icon-self-serve {
    
        opacity: 1;
        transform: rotate(0deg) scale(1);
      
  }

  .intercom-lightweight-app-launcher-icon-self-serve svg {
    height: 56px;
  }

  .intercom-lightweight-app-launcher-icon-self-serve svg path {
    fill: undefined;
  }

  .intercom-lightweight-app-launcher-custom-icon-open {
    max-height: 36px;
    max-width: 36px;
    
        opacity: 1;
        transform: rotate(0deg) scale(1);
      
  }

  .intercom-lightweight-app-launcher-icon-minimize {
    
        opacity: 0;
        transform: rotate(-60deg) scale(0);
      
  }

  .intercom-lightweight-app-launcher-icon-minimize svg {
    width: 16px;
  }

  .intercom-lightweight-app-launcher-icon-minimize svg path {
    fill: undefined;
  }

  .intercom-lightweight-app-messenger {
    position: fixed;
    z-index: 2147483003;
    overflow: hidden;
    background-color: white;
    animation: intercom-lightweight-app-messenger 250ms ease-out;
    
        width: 376px;
        height: calc(100% - 40px);
        max-height: 704px;
        min-height: 250px;
        right: 20px;
        bottom: 20px;
        box-shadow: 0 5px 40px rgba(0,0,0,0.16);
        border-radius: 8px;
      
  }

  .intercom-lightweight-app-messenger-header {
    height: 75px;
    background: linear-gradient(
      135deg,
      undefined 0%,
      undefined 100%
    );
  }

  @media print {
    .intercom-lightweight-app {
      display: none;
    }
  }
</style></div></body></html>