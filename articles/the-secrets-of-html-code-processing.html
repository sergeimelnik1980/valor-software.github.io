<html data-wf-domain="https://valor-software.com" data-wf-page="5df374d1014f24c851af97bf" data-wf-site="5c3f0ad89f55ca3a4f8c174c"><head><meta charset="utf-8"><title>TagTide library: make your HTML content editor-friendly and more</title><meta content="I needed to create a simple web application based on a WYSIWYG HTML editor that counts different parts of text like paragraphs, sentences, words, and characters. The main feature is that you can take (copy-paste) the text from a great variety of resources like websites, Google Docs, MS Office, email clients, etc.The thing is that external content from most of the resources above contains a lot of redundant HTML tags. And this could influence the correctness of calculations. Moreover, messed code makes testing an annoying process." name="description"><meta content="TagTide library: make your HTML content editor-friendly and more" property="og:title"><meta content="I needed to create a simple web application based on a WYSIWYG HTML editor that counts different parts of text like paragraphs, sentences, words, and characters. The main feature is that you can take (copy-paste) the text from a great variety of resources like websites, Google Docs, MS Office, email clients, etc.The thing is that external content from most of the resources above contains a lot of redundant HTML tags. And this could influence the correctness of calculations. Moreover, messed code makes testing an annoying process." property="og:description"><meta content="https://valor-software.com/assets/images/61fc1db4d535eb0e1ce201f1_3301602.jpg" property="og:image"><meta content="TagTide library: make your HTML content editor-friendly and more" property="twitter:title"><meta content="I needed to create a simple web application based on a WYSIWYG HTML editor that counts different parts of text like paragraphs, sentences, words, and characters. The main feature is that you can take (copy-paste) the text from a great variety of resources like websites, Google Docs, MS Office, email clients, etc.The thing is that external content from most of the resources above contains a lot of redundant HTML tags. And this could influence the correctness of calculations. Moreover, messed code makes testing an annoying process." property="twitter:description"><meta content="https://valor-software.com/assets/images/61fc1db4d535eb0e1ce201f1_3301602.jpg" property="twitter:image"><meta property="og:type" content="website"><meta content="summary_large_image" name="twitter:card"><meta content="width=device-width, initial-scale=1" name="viewport"><link href="https://valor-software.com/assets/css/valor.0d446f834.min.css" rel="stylesheet" type="text/css"><script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js" type="text/javascript"></script><script type="text/javascript">WebFont.load({  google: {    families: ["Lato:100,100italic,300,300italic,400,400italic,700,700italic,900,900italic","Source Code Pro:regular"]  }});</script><!--[if lt IE 9]><script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js" type="text/javascript"></script><![endif]--><script type="text/javascript">!function(o,c){var n=c.documentElement,t=" w-mod-";n.className+=t+"js",("ontouchstart"in o||o.DocumentTouch&&c instanceof DocumentTouch)&&(n.className+=t+"touch")}(window,document);</script><link href="https://valor-software.com/assets/images/5c811f6cd8195286971e9cb2_fav32.png" rel="shortcut icon" type="image/x-icon"><link href="https://valor-software.com/assets/images/5c811f71231350647fd8219d_fav256.png" rel="apple-touch-icon"><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-73071494-2"></script><script type="text/javascript">window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());gtag('config', 'UA-73071494-2', {'anonymize_ip': false});</script><!--Social media cover image-->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@ValorSoft">
<meta name="twitter:creator" content="@ValorSoft">
<meta property="og:image" content="https://valor-software.com/assets/images/5c9ca628202d433b51139d07_valor__soc.jpg">
<!-- Google console -->
<meta name="google-site-verification" content="V8GuXYLElkB-DyKBZ-F37ByQFJBrIwsT_v_N9kULChY">
<style>
/*Reset apple form styles*/
input, textarea, select { 
-webkit-appearance: none; 
-moz-appearance: none; 
appearance: none; border-radius: 0; 
background-image: none; }  
/*Remove legature for the font*/
* {
font-variant-ligatures: none;
}
</style>
<!--<meta name="google-site-verification" content="aKWCJbKr9azHpYeEU_4-omBBlky5cQKJgakGXnBcteU" />-->

<script>
  window.intercomSettings = {
    app_id: "brxsww1a"
  };
</script>
<script>
// We pre-filled your app ID in the widget URL: 'https://widget.intercom.io/widget/brxsww1a'
(function(){var w=window;var ic=w.Intercom;if(typeof ic==="function"){ic('reattach_activator');ic('update',w.intercomSettings);}else{var d=document;var i=function(){i.c(arguments);};i.q=[];i.c=function(args){i.q.push(args);};w.Intercom=i;var l=function(){var s=d.createElement('script');s.type='text/javascript';s.async=true;s.src='https://widget.intercom.io/widget/brxsww1a';var x=d.getElementsByTagName('script')[0];x.parentNode.insertBefore(s,x);};if(w.attachEvent){w.attachEvent('onload',l);}else{w.addEventListener('load',l,false);}}})();
</script><style>
/*Blog Highlight CSS*/
code, kbd, pre, samp {
    font-size: 0.8em !important;
    line-height: 1.6em !important;
}
.hljs {
    padding: 20px !important;
}
.rich-text h6 {
    word-wrap: break-word;
}
</style>
<!--Blog Highlight JS-->
<link rel="stylesheet" href="https://valor-software.com/assets/images/github.css">
<script charset="UTF-8" src="https://valor-software.com/assets/js/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script></head><body><div data-collapse="medium" data-animation="over-left" data-duration="400" data-doc-height="1" data-easing="ease" data-easing2="ease" role="banner" class="navbar w-nav"><div class="container"><div class="nav"><a href="https://valor-software.com" class="brand w-nav-brand"><img src="https://valor-software.com/assets/images/5c595f3c4983ad4f7e7701c0_5c4ae3480900f7a7d3ce36d6_02-svg-valor-software-logo-white-text.svg" alt="Valor Software logo"></a><nav role="navigation" class="navbar__links w-nav-menu"><a href="https://valor-software.com/services.html" class="navbar__link">Services</a><a href="https://valor-software.com/clients.html" class="navbar__link">Clients</a><a href="https://valor-software.com/about.html" class="navbar__link">About</a><a href="https://valor-software.com/approach.html" class="navbar__link">Approach</a><a href="https://valor-software.com/careers.html" class="navbar__link">Careers</a><a href="https://valor-software.com/blog.html" class="navbar__link">Blog</a><a href="https://valor-software.com/contact.html" class="navbar__link">Contact</a><a rel="noreferrer" href="https://github.com/valor-software" target="_blank" class="nav__link w-inline-block"><img src="https://valor-software.com/assets/images/5c4f2b2edfbd6c3b9f281ea9_github.svg" width="40" height="40" alt="Github link" class="image-3"></a></nav></div><nav class="menu-btn w-nav-button"><div class="navbar_menu-icon w-icon-nav-menu"></div></nav></div></div><div style="background-image:url(&quot;https://valor-software.com/assets/images/61fc1db4d535eb0e1ce201f1_3301602.jpg&quot;)" class="header"><div class="container container__narrow"><div class="header__wrap"><h1 class="hero__heading hero__heading-blog">TagTide library: make your HTML content editor-friendly and more</h1><div class="auth__wrap"><a href="https://valor-software.com/persons/vyacheslav-chub.html" class="author__link w-inline-block"><div class="auth__photo"><div style="background-image:url(&quot;https://valor-software.com/assets/images/5c814a507773034dcc12c3dd_ava-chub.jpg&quot;)" class="auth__photo-ava"></div></div><div class="auth__desc"><h2 class="blog-author__author-name">Vyacheslav Chub</h2><h6 class="blog-author__role">Full Stack Software Engineer</h6></div></a></div><div class="art__date"><div class="auth__date">February 3, 2022</div><div class="translator__wrap"><div class="translator__prefix w-condition-invisible">Traduzido por</div><div class="translator__name w-dyn-bind-empty"></div></div></div></div></div><div class="p-header p-header--blue"></div></div><div class="section-w wf-section"><div class="container container__narrow"><div class="rich-text w-richtext"><p>A couple of months ago, one of my customers approached me with an interesting task. At first glance, this task did not look complicated at all. I needed to create a relatively simple web application based on a WYSIWYG HTML editor that counts different text units: paragraphs, sentences, words, and characters. The best thing is that you can insert texts from a great variety of resources like websites, Google Docs, MS Office, email clients and get them analyzed for the units. Also, despite the specifics of the source, the app will display your text nicely so you can absorb it.<br></p><p>No prizes for guessing what kind of issue we have in this case :) The thing is that external content from most of the resources above contains a lot of redundant HTML tags. And this could influence the correctness of calculations. Moreover, messed code makes testing an annoying process. So, eventually, I came up with the solution for cleaning HTML from unnecessary tags and polishing it for further work with text.<br></p><h4><strong>Table of contents:</strong><br></h4><p>1. The principles of HTML code prettifying</p><p>2. My solution – the TagTide library</p><p>3. Approaches and use cases</p><p>4. An example with content from Google Docs</p><p>5. Kind thanks to colleagues</p><p>6. Useful links<br></p><h2>The principles of HTML code prettifying</h2><p>Let's think about basic steps to get "editor-friendly" HTML code. I'm going to describe the idea with a demonstrative example. Imagine we have a perfect code that defines paragraphs.<br></p><p>The code could be the following:</p><pre><code class="html">
&lt;p&gt;Shakespeare produced most of his known works between 1589 and 1613.&lt;/p&gt; 
&lt;p&gt;His early plays were primarily comedies and histories and are regarded as some of the best work produced in these genres. He then wrote mainly 
tragedies until 1608, among them Hamlet, Romeo and Juliet, Othello, King Lear, and Macbeth, all considered to be among the finest works in the English language.&lt;/p&gt;
</code></pre><p>The example above contains a couple of paragraphs. The second paragraph contains two sentences, and the first one – just one.<br></p><p>Let's look at the hypothetical messy equivalent of the same content:</p><pre><code class="html">
&lt;div id="content"&gt; 
 &lt;div class="sent"&gt;Shakespeare produced most of his known works between &lt;span style="color: red; font-size: 24px;"&gt;1589&lt;/span&gt; and 
    &lt;span style="color: red"&gt;1613&lt;/span&gt;. 
 &lt;/div&gt; 
 &lt;div&gt; 
  &lt;div class="sent"&gt;His early plays were primarily comedies and histories and are regarded as some of the best work produced in these genres.&lt;/div&gt; 
  &lt;div class="sent"&gt;He then wrote mainly tragedies until 1608, 
among them Hamlet, Romeo and Juliet, Othello, King Lear, and Macbeth, all considered to be among the finest works in the English language.&lt;/div&gt; 
 &lt;div&gt; 
&lt;/div&gt; 
</code></pre><br><h4>What issues this messiness brings:<br></h4><p>1. Root div is redundant and should be ignored.</p><p>2. Since a div placed in another div is correct, but a paragraph placed in another paragraph is a mistake, it's challenging to split the text into paragraphs.</p><p>3. Inline styles uglify whole text perception, but they don't even influence calculation quality. We should get rid of them for aesthetic reasons.<br></p><h4>Steps to editor-friendly text</h4><p>Our main goal is to transform the messy text into perfect paragraphs. Let's call this kind of text "editor-friendly". As far as the task contains various logic, we need to split the flow into separate activities. Let's dig into that!<br></p><p>The first reasonable thing is that we need to ignore root div.</p><pre><code class="html">
&lt;div class="sent"&gt;Shakespeare produced most of his known works between 
&lt;span style="color: red; font-size: 24px;"&gt;1589&lt;/span&gt; and &lt;span 
style="color: red"&gt;1613&lt;/span&gt;.&lt;/div&gt; &lt;div&gt;&lt;div class="sent"&gt;His early 
plays were primarily comedies and histories and are regarded as some of 
the best work produced in these genres.&lt;/div&gt; &lt;div class="sent"&gt;He then 
wrote mainly tragedies until 1608, among them Hamlet, Romeo and Juliet, Othello, King Lear, and Macbeth, all considered to be among the finest works in the English language.&lt;/div&gt;&lt;div&gt;&lt;/div&gt;&lt;/div&gt;
</code></pre><p>Looks better. Secondly, we should flatten the second sentence. It means we should leave only one (in this case, root) level of divs:</p><pre><code class="html">
&lt;div class="sent"&gt;Shakespeare produced most of his known works between 1589
and 1613.&lt;/div&gt; &lt;div&gt;His early plays were primarily comedies and histories
and are regarded as some of the best work produced in these genres. He 
then wrote mainly tragedies until 1608, among them Hamlet, Romeo and Juliet, Othello, King Lear, and Macbeth, all considered to be among the finest works in the English language.&lt;/div&gt;
</code></pre><p>Our text looks much better because the second paragraph looks good. But if we talk about editor-friendly HTML code, we should change divs to pure paragraphs:</p><pre><code class="html">
&lt;p class="sent"&gt;Shakespeare produced most of his known works between 1589 and 1613.&lt;/p&gt;&lt;p&gt;His early plays were primarily comedies and histories and are regarded as some of the best work produced in these genres. He then wrote mainly tragedies until 1608, among them Hamlet, Romeo and Juliet, Othello, King Lear, and Macbeth, all considered to be among the finest works in the English language.&lt;/p&gt;
</code></pre><p>Looks almost perfect! We have just minor stuff left. We need to remove all redundant tag attributes ("class" in our case):</p><pre><code class="html">
&lt;p&gt;Shakespeare produced most of his known works between 1589 and 1613.&lt;/p&gt;&lt;p&gt;His early plays were primarily comedies and histories and are regarded as some of the best work produced in these genres. He then wrote mainly tragedies until 1608, among them Hamlet, Romeo and Juliet, Othello, King Lear, and Macbeth, all considered to be among the finest works in the English language.&lt;/p&gt;
</code></pre><br><p>That's it. We have 100% editor-friendly HTML code that contains a couple of pure paragraphs!<br></p><p>In conclusion, I want to summarize all provided steps that you can use as a separate pattern:<br></p><p>1. Start from a certain point in the original code. You can ignore redundant tags that aren't important anymore.</p><p>2. Flatten the code by removing redundant inner tags. The main goal of this step is preparation for paragraph splitting.</p><p>3. Change div tags to paragraphs.</p><p>4. Remove redundant attributes.<br></p><h2>Technical approaches</h2><p>At the start of the project, I intended to resolve the principles above via sets of pure regular expressions. As you can guess, this attempt failed. Regular expressions are not friendly with deep-nested lexemes. In this case, by lexemes, I mean nested HTML tags and their attributes. Having thought a little, I decided to use the <a href="https://en.wikipedia.org/wiki/Abstract_syntax_tree" target="_blank">AST-based</a> approach because I shouldn't reinvent the wheel in this case. I chose the <a href="https://github.com/henrikjoreteg/html-parse-stringify" target="_blank">HTML-parse-stringify library</a> because this solution is minimalistic yet contains all the expected functionality regarding HTML AST processing.</p><h3><strong>My solution – the TagTide library</strong></h3><p>So, please, welcome <a href="https://github.com/buchslava/tag-tide" target="_blank">TagTide</a>. The main idea of the solution is a set of patterns you can apply anytime when you need them. Also, I imagine you apply them in sequence, just like the steps above.<br></p><p>Let's repeat the steps of the above text transformations using TagTide.<br></p><div class="w-embed"><pre><code class="typescript">
import { TagTide } from "tag-tide";

const original = `
    &lt;div id="content"&gt;&lt;div class="sent"&gt;Shakespeare produced most of his known works between &lt;span style="color: red; font-size: 24px;"&gt;1589&lt;/span&gt; and
         &lt;span style="color: red"&gt;1613&lt;/span&gt;.&lt;/div&gt;
    &lt;div&gt;&lt;div class="sent"&gt;His early plays were primarily comedies and histories and are regarded as some of the best work produced in these genres.&lt;/div&gt;
      &lt;div class="sent"&gt;He then wrote mainly tragedies until 1608, among them Hamlet, Romeo and Juliet, Othello, King Lear, and Macbeth, all considered to be among the finest works in the English language.&lt;/div&gt;&lt;div&gt;&lt;/div&gt;`;
const tagTide = new TagTide(original).startAfter("id", /^content/);
const startedAfter = tagTide.result();

console.log(startedAfter, "\n");

tagTide.flatten();
const flattened = tagTide.result();

console.log(flattened, "\n");

tagTide.rootParagraphs();
const paragraphs = tagTide.result();

console.log(paragraphs, "\n");

tagTide.removeAttributes();
const pureHtml = tagTide.result();

console.log(pureHtml);
</code></pre></div><p>Also, TagTide allows you to get the expected result in the shortest way handling the request in sequence by different objects (<a href="https://www.dofactory.com/javascript/design-patterns/chain-of-responsibility" target="_blank">a chain of responsibility pattern</a>):</p><div class="w-embed"><pre><code class="typescript">
import { TagTide } from "tag-tide";

const original = `
    &lt;div id="content"&gt;&lt;div class="sent"&gt;Shakespeare produced most of his known works between &lt;span style="color: red; font-size: 24px;"&gt;1589&lt;/span&gt; and
         &lt;span style="color: red"&gt;1613&lt;/span&gt;.&lt;/div&gt;
    &lt;div&gt;&lt;div class="sent"&gt;His early plays were primarily comedies and histories and are regarded as some of the best work produced in these genres.&lt;/div&gt;
      &lt;div class="sent"&gt;He then wrote mainly tragedies until 1608, among them Hamlet, Romeo and Juliet, Othello, King Lear, and Macbeth, all considered to be among the finest works in the English language.&lt;/div&gt;&lt;div&gt;&lt;/div&gt;`;
const pureHtml = new TagTide(original).startAfter("id", /^content/).flatten().rootParagraphs().removeAttributes().result();

console.log(pureHtml);
</code></pre></div><h2>Use cases<br></h2><p>There is a couple fundamental approaches how to change your HTML code using TagTide:<br></p><p>1. Direct changes via <strong>`traverse`</strong>;</p><p>2. Changes via the set of patterns.<br></p><p>This part contains different examples illustrating the approaches above.</p><h4><strong>Change some content in 2nd nesting level</strong><br></h4><div class="w-embed"><pre><code class="typescript">
import { El, TagTide } from "tag-tide";

const original = "<div>level 1 <div>level 2 <div>level 3</div></div></div>";
const prettified = new TagTide(original)
  .traverse((el: El, level: number) =&gt; {
    if (level === 2 &amp;&amp; el.content) {
      el.content = `modified ${el.content}`;
    }
  })
  .result();

console.log(prettified);
</code></pre></div><p>Output:</p><div class="w-embed"><pre><code class="typescript">
&lt;div&gt;level 1 &lt;div&gt;modified level 2 &lt;div&gt;level 3&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;
</code></pre></div><h4><strong>Aggregate numeric values from different nesting levels</strong></h4><div class="w-embed"><pre><code class="typescript">
import { El, TagTide } from "tag-tide";

const original = "<div>1 <div>2 <div>3</div></div></div>";
let total = 0;
new TagTide(original).traverse((el: El) =&gt; {
  if (el.content) {
    total += +el.content.trim();
  }
});

console.log(total);
</code></pre></div><p>Output:</p><div class="w-embed"><pre><code class="html">
`6`
</code></pre></div><h4><strong>Strip some tags</strong></h4><div class="w-embed"><pre><code class="typescript">
import { TagTide } from "tag-tide";

const original = "<div>level 1 <div><a href="#"><span>level <i>2</i></span></a> <div>level 3<br></div></div></div>";
const prettified = new TagTide(original)
  .result(['a', 'span', 'i', 'br']);

console.log(prettified);
</code></pre></div><p>Output:</p><div class="w-embed"><pre><code class="typescript">
&lt;div&gt;level 1 &lt;div&gt;level 2 &lt;div&gt;level 3&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;
</code></pre></div><h4><strong>Start after or Start from</strong><br></h4><p>This pattern allows us to ignore some parent structures.<br></p><div class="w-embed"><pre><code class="typescript">
import { TagTide } from "tag-tide";

const source = `<div class="container-1"><p>content</p></div>`;
const result = new TagTide(source)
  .startAfter("class", /^container-\d/)
  .result();

console.log(result);
</code></pre></div><p>Output:</p><div class="w-embed"><pre><code class="typescript">
&lt;p&gt;content&lt;/p&gt;
</code></pre></div><p>The following code illustrates another approach to set starter-tag. Also, related tag can be included:</p><div class="w-embed"><pre><code class="typescript">
import { TagTide } from "tag-tide";

const source = `<div class="container-1"><p>content</p></div>`;
const result = new TagTide(source)
  .startFrom("class", /^container-\d/)
  .result();

console.log(result);
</code></pre></div><p>Output:</p><div class="w-embed"><pre><code class="typescript">
&lt;div class="container-1"&gt;&lt;p&gt;content&lt;/p&gt;&lt;/div&gt;
</code></pre></div><p>Important notes:<br></p><p>1. In the "Start With" case, the result will include the associated (search) tag.</p><p>2. If no matching tag is found, these patterns don't affect the result.<br></p><h4><strong>Flatten</strong><br></h4><p>This pattern will be useful if we need to remove nested tags.</p><div class="w-embed"><pre><code class="typescript">
import { TagTide } from "tag-tide";

const original =
  "<div>1 <div id="first">2 <div><span class="foo" style="color: red;">3</span></div></div></div> middle <div>4 <div>5</div></div>";
const prettified = new TagTide(original).flatten().result();

console.log(prettified);
</code></pre></div><p>Output:</p><div class="w-embed"><pre><code class="typescript">
&lt;div&gt;1 2 3&lt;/div&gt; middle &lt;div&gt;4 5&lt;/div&gt;
</code></pre></div><p>Also, you can omit any tags that you want except for those you need to keep (ex. &lt;br&gt;, &lt;b&gt;,etc.):<br></p><div class="w-embed"><pre><code class="typescript">
import { TagTide } from "tag-tide";

const original =
  "<div>1 <div id="first">2 <div><span class="foo" style="color: red;"><a href="https://valor-software.com/1.html" target="_blank">3</a></span></div></div></div> middle <div>4 <div>5</div></div>";
const prettified = new TagTide(original).flatten(['a']).result();

console.log(prettified);
</code></pre></div><p>Output:</p><div class="w-embed"><pre><code class="typescript">
&lt;div&gt;1 2 &lt;a href="1" target="_blank"&gt;3&lt;/a&gt;&lt;/div&gt; middle &lt;div&gt;4 5&lt;/div&gt;
</code></pre></div><h4><strong>Remove attributes</strong><br></h4><p>This pattern allows removing all or some attributes through the whole content.<br></p><p>In the following example, all attributes have been removed.<br></p><div class="w-embed"></div><p>Output:</p><div class="w-embed"><pre><code class="typescript">
&lt;div&gt;1 &lt;div&gt;2 &lt;div&gt;&lt;span&gt;3&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt; middle &lt;div&gt;4 &lt;div&gt;5&lt;/div&gt;&lt;/div&gt;
</code></pre></div><p>In the following example, all attributes have been removed except:<br></p><p>* <strong>`id`</strong> attribute in all <strong>`span`</strong> tags</p><p>* all <strong>`style`</strong> attributes<br></p><div class="w-embed"><pre><code class="typescript">
import { TagTide } from "tag-tide";

const original =
  "<div>1 <div id="first">2 <div><span id="s1" class="foo" style="color: red;">3</span></div></div></div> middle <div style="color: red;">4 <div>5</div></div>";
const prettified = new TagTide(original).removeAttributes({'span': ['id'], '*': ['style']}).result();

console.log(prettified);
</code></pre></div><p>Output:</p><div class="w-embed"><pre><code class="typescript">
&lt;div&gt;1 &lt;div&gt;2 &lt;div&gt;&lt;span id="s1" style="color: red;"&gt;3&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt; middle &lt;div style="color: red;"&gt;4 &lt;div&gt;5&lt;/div&gt;&lt;/div&gt;
</code></pre></div><h4><strong>Root paragraphs</strong><br></h4><p>We need to replace the <strong>`divs`</strong> in the first level of HTML with <strong>`paragraphs`</strong>. If the <strong>`plain text`</strong> appears at the <strong>`first level`</strong> instead of another tag, it should be enclosed in a <strong>`paragraph`</strong>.<br></p><p>The following example shows how this approach works.</p><div class="w-embed"><pre><code class="typescript">
import { TagTide } from "tag-tide";

const original = "<div>start</div> middle <div>finish</div>";
const prettified = new TagTide(original).rootParagraphs().result();

console.log(prettified);
</code></pre></div><p>Output:</p><div class="w-embed"><pre><code class="typescript">
&lt;p&gt;start&lt;/p&gt;&lt;p&gt; middle &lt;/p&gt;&lt;p&gt;finish&lt;/p&gt;
</code></pre></div><h2>An example with content from Google Docs<br></h2><p>And now all we need is the icing on the cake. Look at <a href="https://github.com/buchslava/tag-tide/blob/main/examples/complex.ts" target="_blank">the code </a>containing HTML that I took from an actual Google Docs document and how it can be prettified with the library later on.</p><div class="w-embed"><pre><code class="typescript">
import { TagTide } from "../src";

const htmlFromGoogleDocs = `
    &lt;meta http-equiv="content-type" content="text/html; charset=utf-8"&gt;
    &lt;meta charset="utf-8"&gt;
    &lt;b style="font-weight:normal;" id="docs-internal-guid-f45b8314-7fff-c131-346a-1affd24e93d7"&gt;
      &lt;p dir="ltr" style="line-height:1.38;margin-top:0pt;margin-bottom:0pt;"&gt;
        &lt;span style="font-size:13pt;font-family:Arial;color:#000000;background-color:transparent;font-weight:700;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre;white-space:pre-wrap;"&gt;Test &lt;/span&gt;
        &lt;span style="font-size:13pt;font-family:Arial;color:#000000;background-color:transparent;font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre;white-space:pre-wrap;"&gt;test test&lt;/span&gt;
      &lt;/p&gt;
      &lt;p dir="ltr" style="line-height:1.38;margin-top:0pt;margin-bottom:0pt;"&gt;
        &lt;span style="font-size:13.999999999999998pt;font-family:Arial;color:#000000;background-color:transparent;font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre;white-space:pre-wrap;"&gt;Test test test&lt;/span&gt;
      &lt;/p&gt;
      &lt;p dir="ltr" style="line-height:1.38;margin-top:0pt;margin-bottom:0pt;"&gt;&lt;a href="http://www.microsoft.com" style="text-decoration:none;"&gt;&lt;span style="font-size:11pt;font-family:Arial;color:#1155cc;background-color:transparent;font-weight:400;font-style:normal;font-variant:normal;text-decoration:underline;-webkit-text-decoration-skip:none;text-decoration-skip-ink:none;vertical-align:baseline;white-space:pre;white-space:pre-wrap;"&gt;Test&lt;/span&gt;&lt;/a&gt;&lt;span style="font-size:11pt;font-family:Arial;color:#000000;background-color:transparent;font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre;white-space:pre-wrap;"&gt; test test&lt;/span&gt;&lt;/p&gt;
      &lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;div dir="ltr" style="margin-left:0pt;" align="left"&gt;
      &lt;table style="border:none;border-collapse:collapse;table-layout:fixed;width:468pt"&gt;&lt;colgroup&gt;&lt;col /&gt;&lt;col /&gt;&lt;/colgroup&gt;&lt;tbody&gt;
         &lt;tr style="height:0pt"&gt;&lt;td style="border-left:solid #000000 1pt;border-right:solid #000000 1pt;border-bottom:solid #000000 1pt;border-top:solid #000000 1pt;vertical-align:top;padding:5pt 5pt 5pt 5pt;overflow:hidden;overflow-wrap:break-word;"&gt;&lt;p dir="ltr" style="line-height:1.2;margin-top:0pt;margin-bottom:0pt;"&gt;&lt;span style="font-size:11pt;font-family:Arial;color:#000000;background-color:transparent;font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre;white-space:pre-wrap;"&gt;1&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td style="border-left:solid #000000 1pt;border-right:solid #000000 1pt;border-bottom:solid #000000 1pt;border-top:solid #000000 1pt;vertical-align:top;padding:5pt 5pt 5pt 5pt;overflow:hidden;overflow-wrap:break-word;"&gt;&lt;p dir="ltr" style="line-height:1.2;margin-top:0pt;margin-bottom:0pt;"&gt;&lt;span style="font-size:11pt;font-family:Arial;color:#000000;background-color:transparent;font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre;white-space:pre-wrap;"&gt;2&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;
         &lt;tr style="height:0pt"&gt;&lt;td style="border-left:solid #000000 1pt;border-right:solid #000000 1pt;border-bottom:solid #000000 1pt;border-top:solid #000000 1pt;vertical-align:top;padding:5pt 5pt 5pt 5pt;overflow:hidden;overflow-wrap:break-word;"&gt;&lt;p dir="ltr" style="line-height:1.2;margin-top:0pt;margin-bottom:0pt;"&gt;&lt;span style="font-size:11pt;font-family:Arial;color:#000000;background-color:transparent;font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre;white-space:pre-wrap;"&gt;3&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td style="border-left:solid #000000 1pt;border-right:solid #000000 1pt;border-bottom:solid #000000 1pt;border-top:solid #000000 1pt;vertical-align:top;padding:5pt 5pt 5pt 5pt;overflow:hidden;overflow-wrap:break-word;"&gt;&lt;p dir="ltr" style="line-height:1.2;margin-top:0pt;margin-bottom:0pt;"&gt;&lt;span style="font-size:11pt;font-family:Arial;color:#000000;background-color:transparent;font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre;white-space:pre-wrap;"&gt;4&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;
      &lt;/tbody&gt;&lt;/table&gt;
      &lt;/div&gt;&lt;br /&gt;&lt;br /&gt;
      &lt;ul style="margin-top:0;margin-bottom:0;padding-inline-start:48px;"&gt;&lt;li dir="ltr" style="list-style-type:disc;font-size:11pt;font-family:Arial;color:#000000;background-color:transparent;font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre;" aria-level="1"&gt;&lt;p dir="ltr" style="line-height:1.38;margin-top:0pt;margin-bottom:0pt;" role="presentation"&gt;&lt;span style="font-size:11pt;font-family:Arial;color:#000000;background-color:transparent;font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre;white-space:pre-wrap;"&gt;Aaa&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li dir="ltr" style="list-style-type:disc;font-size:11pt;font-family:Arial;color:#000000;background-color:transparent;font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre;" aria-level="1"&gt;&lt;p dir="ltr" style="line-height:1.38;margin-top:0pt;margin-bottom:0pt;" role="presentation"&gt;&lt;span style="font-size:11pt;font-family:Arial;color:#000000;background-color:transparent;font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre;white-space:pre-wrap;"&gt;Bbb&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li dir="ltr" style="list-style-type:disc;font-size:11pt;font-family:Arial;color:#000000;background-color:transparent;font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre;" aria-level="1"&gt;&lt;p dir="ltr" style="line-height:1.38;margin-top:0pt;margin-bottom:0pt;" role="presentation"&gt;&lt;span style="font-size:11pt;font-family:Arial;color:#000000;background-color:transparent;font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre;white-space:pre-wrap;"&gt;Ccc&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;
      &lt;br /&gt;&lt;p dir="ltr" style="line-height:1.38;margin-top:0pt;margin-bottom:0pt;"&gt;&lt;span style="font-size:11pt;font-family:Arial;color:#000000;background-color:transparent;font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre;white-space:pre-wrap;"&gt;The end&lt;/span&gt;&lt;/p&gt;&lt;/b&gt;&lt;br class="Apple-interchange-newline"&gt;`;

const prettified = new TagTide(htmlFromGoogleDocs)
  .startAfter("id", /^docs-internal-guid-.+/)
  .textTable()
  .flatten(["a", "img", "li"])
  .removeAttributes({ a: ["href", "_target"], img: ["src", "alt"] })
  .rootParagraphs()
  .result();

console.log(prettified);
</code></pre></div><p>I suppose you might be surprised with the volume of HTML in the document. Moreover, let's imagine you should work with the text inside. Can you see the text by the way? – I guess not really because there are a lot of trash tags and attributes there. The most exciting thing about this story is that you can run the script above and transform the initial code from my example into the following HTML:<br></p><pre><code class="html">
&lt;p&gt; Test test test &lt;/p&gt;&lt;p&gt; Test test test &lt;/p&gt;&lt;p&gt;&lt;a href="http://www.microsoft.com"&gt;Test&lt;/a&gt; test test&lt;/p&gt;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;p&gt; 
12 34 &lt;/p&gt;&lt;br/&gt;&lt;br/&gt;&lt;ul&gt;&lt;li&gt;Aaa&lt;/li&gt;&lt;li&gt;Bbb&lt;/li&gt;&lt;li&gt;Ccc&lt;/li&gt;&lt;/ul&gt;&lt;br/&gt;&lt;p&gt;The end&lt;/p&gt;
</code></pre><p>And you can repeat the same with the code taken from email clients, MS Word documents, and other sources!</p><h2>In conclusion, I want to thank:<br></h2><p>- <a href="https://www.linkedin.com/in/waqas-younas/" target="_blank">Waqas Younas</a> for long and fruitful cooperation</p><p>-&nbsp; <a href="https://github.com/HenrikJoreteg" target="_blank">Henrik Joreteg</a> for <a href="https://github.com/henrikjoreteg/html-parse-stringify" target="_blank">html-parse-stringify</a></p><p>And in case you're interested in other solutions for text editing and processing, check my <a href="https://valor-software.com/articles/multi-highlighting-for-draftjs.html" target="_blank">Multi-Highlighting for DraftJS </a>article. There I share how I added an option to highlight paragraphs, phrases, and words in DraftJS with my solution written in TypeScript.</p><h2>Useful links</h2><ul role="list"><li><a href="https://valor-software.com/articles/multi-highlighting-for-draftjs.html" target="_blank">‍HTML-parse-stringify library</a> for HTML AST processing</li><li><a href="https://github.com/buchslava/tag-tide" target="_blank">The TagTide library on GitHub</a></li><li><a href="https://github.com/henrikjoreteg/html-parse-stringify" target="_blank">TagTide on npm</a></li><li><a href="https://valor-software.com/articles/multi-highlighting-for-draftjs.html">‍Multi-Highlighting for DraftJS</a> - my other solution for highlighting text units in DraftJS editor<br></li></ul></div><div class="translator__wrap bottom"><div class="translator__prefix bottom w-condition-invisible">Traduzido por</div><div class="translator__name bottom w-dyn-bind-empty"></div></div></div></div><div class="section-sub wf-section"><div class="container container__narrow blog__alt"><h2 class="sub__header">Subscribe to find out more</h2><div class="form w-form"><form id="wf-form-Article-s-Subscribe-Form" name="wf-form-Article-s-Subscribe-Form" data-name="Article's Subscribe Form" method="get" class="art__form"><input type="email" class="sub__input w-input" maxlength="256" name="Email" data-name="Email" placeholder="Your e-mail" id="Email" required=""><input type="submit" value="Submit" data-wait="Please wait..." class="btn w-button"></form><div class="form__suc-bg w-form-done"><h3 class="sec__suc-2">Thank you!</h3><div> Your submission has been received!</div></div><div class="w-form-fail"><div>Oops! Something went wrong while submitting the form.</div></div></div></div></div><div class="section-art wf-section"><div class="container container__narrow"><h2 class="art__heading">More articles</h2><div class="w-dyn-list"><div role="list" class="row w-dyn-items"><div role="listitem" class="col art w-dyn-item"><a href="https://valor-software.com/articles/diving-into-seeking-issue-with-mp3-files.html" class="blog-card w-inline-block"><div style="background-image:url(&quot;https://valor-software.com/assets/images/61fbaed8a4291dddcee69278_Frame_20301.png&quot;)" class="blog-card__img"></div><div class="blog-card__content"><h4 class="blog-card__heading">Diving into seeking issue with MP3 files</h4><div class="blog-card__author"><div style="background-image:url(&quot;https://valor-software.com/assets/images/61fbaf8cc1e0c9364b36bffa_Eduardo_Speroni_Valor-Software.jpeg&quot;)" class="blog-card__author-photo"></div><div><div class="blog-card__author-name">Eduardo Speroni</div><div class="blog-card__author-role">Angular Developer</div></div></div></div></a></div><div role="listitem" class="col art w-dyn-item"><a href="https://valor-software.com/articles/performance-testing-via-artillery-io.html" class="blog-card w-inline-block"><div style="background-image:url(&quot;https://valor-software.com/assets/images/620a792b9a31a62c0be1dad0_Artillery_Performance_testing_Valor_Software.jpeg&quot;)" class="blog-card__img"></div><div class="blog-card__content"><h4 class="blog-card__heading">Performance Testing via Artillery.io</h4><div class="blog-card__author"><div style="background-image:url(&quot;https://valor-software.com/assets/images/5f69c139ad11997382022d15_jemchugov.jpg&quot;)" class="blog-card__author-photo"></div><div><div class="blog-card__author-name">Dmitriy Zhemchugov</div><div class="blog-card__author-role">QA Engineer</div></div></div></div></a></div></div></div></div></div><div class="section-narrow section-narrow--red wf-section"><div class="container cta"><div class="cta__wrap"><div class="act__col"><h2 class="cta__header">Feeling inspired?<br></h2><p class="cta__desc">Let's discuss how Valor Software can help with your project's development needs!</p></div><div class="act__col"><a title="go to the contacts page" href="https://valor-software.com/contact.html" class="btn btn--inverted w-button">let's talk</a></div></div></div></div><div class="section-narrow section-narrow--dark wf-section"><div class="container"><div class="row footer"><div class="col footer__col"><div class="soc__item"><a rel="noreferrer" href="https://github.com/valor-software" target="_blank" class="w-inline-block"><img src="https://valor-software.com/assets/images/5c4f2b2edfbd6c3b9f281ea9_github.svg" width="40" height="40" alt="github icon"></a></div><div class="soc__item"><a rel="noreferrer" href="https://www.behance.net/ValorSoftware" target="_blank" class="w-inline-block"><img src="https://valor-software.com/assets/images/5c4f2b2edfbd6c9e41281ea8_behance.svg" width="40" height="40" alt="behance icon"></a></div><div class="soc__item"><a rel="noreferrer" href="https://www.facebook.com/valorsoftware/" target="_blank" class="w-inline-block"><img src="https://valor-software.com/assets/images/5c4f2b2ee97f83b6b33d3a3f_facebook.svg" width="40" height="40" alt="facebook icon"></a></div><div class="soc__item"><a rel="noreferrer" href="https://twitter.com/ValorSoft" target="_blank" class="w-inline-block"><img src="https://valor-software.com/assets/images/5c4f2b2ec49ea64ca2b3cee5_twitter.svg" width="40" height="40" alt="twitter icon"></a></div><div class="soc__item"><a rel="noreferrer" href="https://www.linkedin.com/company/valor-software/about/" target="_blank" class="w-inline-block"><img src="https://valor-software.com/assets/images/5c4f2b2ea29a8f6adcf1df87_linkedin.svg" width="40" height="40" alt="linkedin icon"></a></div></div><div class="col footer__col"><p class="footer__copyright">© 2020, Valor Software <br>All Rights Reserved</p></div></div></div></div><script src="https://valor-software.com/assets/js/jquery-3.5.1.min.dc5e7f18c8.js?site=5c3f0ad89f55ca3a4f8c174c" type="text/javascript" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script><script src="https://valor-software.com/assets/js/valor.62e147061.js" type="text/javascript"></script><!--[if lte IE 9]><script src="//cdnjs.cloudflare.com/ajax/libs/placeholders/3.0.2/placeholders.min.js"></script><![endif]--><!--Prevent zooming on mobile-->
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">

</body></html>